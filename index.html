<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JEE 2026 Comprehensive Tracker</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        
        const firebaseConfig = {
            apiKey: "AIzaSyDTIqOQxIAoxXbrv-CTBjQncDyy_EcHjWA",
            authDomain: "jee-tracker-5e1e3.firebaseapp.com",
            projectId: "jee-tracker-5e1e3",
            storageBucket: "jee-tracker-5e1e3.firebasestorage.app",
            messagingSenderId: "602366987142",
            appId: "1:602366987142:web:4b169f8da0f876e88f3a07"
        };
        
        try {
            window.firebaseApp = initializeApp(firebaseConfig);
            window.auth = getAuth(window.firebaseApp);
            window.db = getFirestore(window.firebaseApp);
            window.firebaseInitialized = true;
            console.log('Firebase initialized successfully');
        } catch (error) {
            console.error('Firebase initialization error:', error);
            window.firebaseError = error;
            window.firebaseInitialized = false;
        }
    </script>
</head>
<body>
    <div class="particles-bg"></div>
    
    <!-- Enhanced Firebase Connection Status -->
    <div class="firebase-status" id="firebaseStatus">
        <div class="status-indicator" id="statusIndicator"></div>
        <span id="statusText">Connecting...</span>
        <button class="retry-btn hidden" id="retryBtn">Retry</button>
    </div>
    
    <!-- Enhanced Authentication Modal -->
    <div class="modal auth-modal" id="authModal">
        <div class="modal-content glass-card">
            <div class="modal-header">
                <h3>Welcome to JEE 2026 Comprehensive Tracker</h3>
            </div>
            <div class="modal-body">
                <div class="auth-container">
                    <div class="auth-methods">
                        <div class="auth-method" id="googleAuthMethod">
                            <h4>Sign in with Google (Recommended)</h4>
                            <p>Sync your data across all devices</p>
                            <button class="btn btn--primary" id="googleSignInBtn">
                                <svg width="20" height="20" viewBox="0 0 24 24" style="margin-right: 8px;">
                                    <path fill="currentColor" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                    <path fill="currentColor" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                    <path fill="currentColor" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                    <path fill="currentColor" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                                </svg>
                                Sign in with Google
                            </button>
                            <div class="auth-error hidden" id="googleAuthError"></div>
                        </div>
                        
                        <div class="auth-divider">OR</div>
                        
                        <div class="auth-method" id="emailAuthMethod">
                            <h4>Email & Password</h4>
                            <div class="form-group">
                                <input type="email" id="emailInput" class="form-control" placeholder="Email address">
                            </div>
                            <div class="form-group">
                                <input type="password" id="passwordInput" class="form-control" placeholder="Password">
                            </div>
                            <div class="auth-buttons">
                                <button class="btn btn--secondary" id="emailSignInBtn">Sign In</button>
                                <button class="btn btn--outline" id="emailSignUpBtn">Sign Up</button>
                            </div>
                            <div class="auth-error hidden" id="emailAuthError"></div>
                        </div>
                        
                        <div class="auth-divider">OR</div>
                        
                        <div class="auth-method">
                            <h4>Demo Mode</h4>
                            <p>Try the app without creating an account</p>
                            <button class="btn btn--outline" id="demoModeBtn">Continue in Demo Mode</button>
                            <small style="color: rgba(255,255,255,0.6); font-size: 12px; display: block; margin-top: 8px;">
                                Note: Data won't be synced across devices
                            </small>
                        </div>
                    </div>
                    
                    <div class="troubleshooting hidden" id="troubleshooting">
                        <h4>Troubleshooting</h4>
                        <ul>
                            <li>Check your internet connection</li>
                            <li>Disable ad blockers for this site</li>
                            <li>Try refreshing the page</li>
                            <li>Use demo mode if issues persist</li>
                        </ul>
                        <button class="btn btn--secondary btn--sm" id="showTroubleshootingBtn">Show Troubleshooting</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <nav class="navbar">
        <div class="nav-container">
            <h1 class="nav-logo">JEE 2026 Tracker</h1>
            <div class="nav-links">
                <a href="#dashboard" class="nav-link active">Dashboard</a>
                <a href="#chapters" class="nav-link">Chapters</a>
                <a href="#analytics" class="nav-link">Analytics</a>
                <a href="#calendar" class="nav-link">Calendar</a>
                <a href="#todos" class="nav-link">Todos</a>
            </div>
            <div class="nav-controls">
                <div class="user-info" id="userInfo" style="display: none;">
                    <img id="userAvatar" class="user-avatar" alt="User Avatar">
                    <span id="userName">User</span>
                    <button class="btn btn--secondary btn--sm" id="signOutBtn">Sign Out</button>
                </div>
                <button class="btn btn--secondary btn--sm" id="exportBtn">Export Data</button>
                <button class="theme-toggle" id="themeToggle">🌙</button>
            </div>
        </div>
    </nav>

    <main class="main-content">
        <!-- Dashboard Section -->
        <section id="dashboard" class="section active">
            <div class="container">
                <!-- Motivational Quote -->
                <div class="quote-card glass-card">
                    <p class="quote-text" id="motivationalQuote">Loading quote...</p>
                    <span class="quote-author">— Stay Motivated</span>
                </div>

                <!-- Countdown Timers -->
                <div class="countdown-grid">
                    <div class="countdown-card glass-card main1">
                        <div class="countdown-header">
                            <h3>JEE Main 1</h3>
                            <span class="countdown-date">January 20, 2026</span>
                        </div>
                        <div class="countdown-timer" id="countdown-main1">
                            <div class="time-unit">
                                <span class="time-value" id="days-main1">000</span>
                                <span class="time-label">Days</span>
                            </div>
                            <div class="time-unit">
                                <span class="time-value" id="hours-main1">00</span>
                                <span class="time-label">Hours</span>
                            </div>
                            <div class="time-unit">
                                <span class="time-value" id="minutes-main1">00</span>
                                <span class="time-label">Minutes</span>
                            </div>
                            <div class="time-unit">
                                <span class="time-value" id="seconds-main1">00</span>
                                <span class="time-label">Seconds</span>
                            </div>
                        </div>
                    </div>

                    <div class="countdown-card glass-card main2">
                        <div class="countdown-header">
                            <h3>JEE Main 2</h3>
                            <span class="countdown-date">April 1, 2026</span>
                        </div>
                        <div class="countdown-timer" id="countdown-main2">
                            <div class="time-unit">
                                <span class="time-value" id="days-main2">000</span>
                                <span class="time-label">Days</span>
                            </div>
                            <div class="time-unit">
                                <span class="time-value" id="hours-main2">00</span>
                                <span class="time-label">Hours</span>
                            </div>
                            <div class="time-unit">
                                <span class="time-value" id="minutes-main2">00</span>
                                <span class="time-label">Minutes</span>
                            </div>
                            <div class="time-unit">
                                <span class="time-value" id="seconds-main2">00</span>
                                <span class="time-label">Seconds</span>
                            </div>
                        </div>
                    </div>

                    <div class="countdown-card glass-card advanced">
                        <div class="countdown-header">
                            <h3>JEE Advanced</h3>
                            <span class="countdown-date">May 18, 2026</span>
                        </div>
                        <div class="countdown-timer" id="countdown-advanced">
                            <div class="time-unit">
                                <span class="time-value" id="days-advanced">000</span>
                                <span class="time-label">Days</span>
                            </div>
                            <div class="time-unit">
                                <span class="time-value" id="hours-advanced">00</span>
                                <span class="time-label">Hours</span>
                            </div>
                            <div class="time-unit">
                                <span class="time-value" id="minutes-advanced">00</span>
                                <span class="time-label">Minutes</span>
                            </div>
                            <div class="time-unit">
                                <span class="time-value" id="seconds-advanced">00</span>
                                <span class="time-label">Seconds</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Subject Progress Overview -->
                <div class="subject-progress-grid">
                    <div class="subject-card glass-card physics">
                        <h3>Physics Progress</h3>
                        <div class="subject-stats">
                            <div class="stat-item">
                                <span class="stat-value" id="physicsCompleted">0</span>
                                <span class="stat-label">Chapters Completed</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="physicsConfidence">0</span>
                                <span class="stat-label">Avg Confidence</span>
                            </div>
                        </div>
                        <div class="progress-ring">
                            <svg class="progress-circle" width="120" height="120">
                                <circle cx="60" cy="60" r="54" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="8"/>
                                <circle cx="60" cy="60" r="54" fill="none" stroke="#1FB8CD" stroke-width="8" 
                                        stroke-linecap="round" id="physicsProgressCircle"/>
                            </svg>
                            <div class="progress-percentage" id="physicsPercentage">0%</div>
                        </div>
                    </div>
                    
                    <div class="subject-card glass-card chemistry">
                        <h3>Chemistry Progress</h3>
                        <div class="subject-stats">
                            <div class="stat-item">
                                <span class="stat-value" id="chemistryCompleted">0</span>
                                <span class="stat-label">Chapters Completed</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="chemistryConfidence">0</span>
                                <span class="stat-label">Avg Confidence</span>
                            </div>
                        </div>
                        <div class="progress-ring">
                            <svg class="progress-circle" width="120" height="120">
                                <circle cx="60" cy="60" r="54" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="8"/>
                                <circle cx="60" cy="60" r="54" fill="none" stroke="#FFC185" stroke-width="8" 
                                        stroke-linecap="round" id="chemistryProgressCircle"/>
                            </svg>
                            <div class="progress-percentage" id="chemistryPercentage">0%</div>
                        </div>
                    </div>
                    
                    <div class="subject-card glass-card mathematics">
                        <h3>Mathematics Progress</h3>
                        <div class="subject-stats">
                            <div class="stat-item">
                                <span class="stat-value" id="mathematicsCompleted">0</span>
                                <span class="stat-label">Chapters Completed</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value" id="mathematicsConfidence">0</span>
                                <span class="stat-label">Avg Confidence</span>
                            </div>
                        </div>
                        <div class="progress-ring">
                            <svg class="progress-circle" width="120" height="120">
                                <circle cx="60" cy="60" r="54" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="8"/>
                                <circle cx="60" cy="60" r="54" fill="none" stroke="#B4413C" stroke-width="8" 
                                        stroke-linecap="round" id="mathematicsProgressCircle"/>
                            </svg>
                            <div class="progress-percentage" id="mathematicsPercentage">0%</div>
                        </div>
                    </div>
                </div>

                <!-- Daily Question Tracker -->
                <div class="tracker-grid">
                    <div class="tracker-card glass-card">
                        <h3>Daily Question Logger</h3>
                        <div class="form-group">
                            <label for="questionDate">Select Date</label>
                            <input type="date" id="questionDate" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="questionsCount">Total Questions</label>
                            <input type="number" id="questionsCount" class="form-control" min="0" placeholder="Auto-calculated">
                        </div>
                        <div class="subject-inputs">
                            <div class="form-group">
                                <label for="physicsCount">Physics</label>
                                <input type="number" id="physicsCount" class="form-control" min="0" placeholder="0">
                            </div>
                            <div class="form-group">
                                <label for="chemistryCount">Chemistry</label>
                                <input type="number" id="chemistryCount" class="form-control" min="0" placeholder="0">
                            </div>
                            <div class="form-group">
                                <label for="mathCount">Mathematics</label>
                                <input type="number" id="mathCount" class="form-control" min="0" placeholder="0">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="dailyTarget">Daily Target</label>
                            <input type="number" id="dailyTarget" class="form-control" min="1" value="50">
                        </div>
                        <button class="btn btn--primary btn--full-width" id="saveProgress">Save Progress</button>
                    </div>

                    <div class="progress-card glass-card">
                        <h3>Today's Progress</h3>
                        <div class="progress-stats">
                            <div class="stat-item">
                                <span class="stat-label">Questions Solved</span>
                                <span class="stat-value" id="todayQuestions">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Daily Target</span>
                                <span class="stat-value" id="todayTarget">50</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Progress</span>
                                <span class="stat-value" id="todayProgress">0%</span>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="circular-progress" id="circularProgress">
                            <svg class="circular-chart">
                                <defs>
                                    <linearGradient id="progressGradient">
                                        <stop offset="0%" stop-color="#64ffda"/>
                                        <stop offset="100%" stop-color="#1de9b6"/>
                                    </linearGradient>
                                </defs>
                                <circle class="circle-bg" cx="60" cy="60" r="54"></circle>
                                <circle class="circle-progress" cx="60" cy="60" r="54" id="progressCircle"></circle>
                            </svg>
                            <div class="progress-text">
                                <span id="progressPercentage">0%</span>
                                <span>Complete</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Chapter Tracking Section -->
        <section id="chapters" class="section">
            <div class="container">
                <div class="section-header">
                    <h2>JEE Chapter Tracking</h2>
                    <div class="chapter-controls">
                        <button class="btn btn--secondary" id="exportChapterData">Export Chapter Data</button>
                        <input type="file" id="importChapterFile" accept=".json" style="display: none;">
                        <button class="btn btn--secondary" id="importChapterData">Import Data</button>
                    </div>
                </div>
                
                <div class="subjects-container">
                    <!-- Physics Chapters -->
                    <div class="subject-section" id="physicsSection">
                        <div class="subject-header">
                            <h3>📘 Physics (10 Chapters)</h3>
                            <div class="subject-progress-bar">
                                <div class="progress-fill" id="physicsProgressBar"></div>
                                <span class="progress-text" id="physicsProgressText">0/10</span>
                            </div>
                        </div>
                        <div class="chapters-grid" id="physicsChapters">
                            <!-- Physics chapters will be generated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Chemistry Chapters -->
                    <div class="subject-section" id="chemistrySection">
                        <div class="subject-header">
                            <h3>🧪 Chemistry (20 Chapters)</h3>
                            <div class="subject-progress-bar">
                                <div class="progress-fill" id="chemistryProgressBar"></div>
                                <span class="progress-text" id="chemistryProgressText">0/20</span>
                            </div>
                        </div>
                        <div class="chapters-grid" id="chemistryChapters">
                            <!-- Chemistry chapters will be generated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Mathematics Chapters -->
                    <div class="subject-section" id="mathematicsSection">
                        <div class="subject-header">
                            <h3>📐 Mathematics (18 Chapters)</h3>
                            <div class="subject-progress-bar">
                                <div class="progress-fill" id="mathematicsProgressBar"></div>
                                <span class="progress-text" id="mathematicsProgressText">0/18</span>
                            </div>
                        </div>
                        <div class="chapters-grid" id="mathematicsChapters">
                            <!-- Mathematics chapters will be generated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Analytics Section -->
        <section id="analytics" class="section">
            <div class="container">
                <h2>Analytics Dashboard</h2>
                <div class="loading-state" id="analyticsLoading">
                    <div class="loading-spinner"></div>
                    <p>Loading charts...</p>
                </div>
                <div class="charts-grid" id="chartsContainer" style="display: none;">
                    <div class="chart-card glass-card">
                        <h3>Daily Progress Trend</h3>
                        <div class="chart-container" style="position: relative; height: 400px;">
                            <canvas id="progressChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card glass-card">
                        <h3>Subject Distribution</h3>
                        <div class="chart-container" style="position: relative; height: 400px;">
                            <canvas id="subjectChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card glass-card">
                        <h3>Chapter Completion</h3>
                        <div class="chart-container" style="position: relative; height: 400px;">
                            <canvas id="chapterChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card glass-card">
                        <h3>Confidence Levels</h3>
                        <div class="chart-container" style="position: relative; height: 400px;">
                            <canvas id="confidenceChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Calendar Section -->
        <section id="calendar" class="section">
            <div class="container">
                <h2>Study Calendar</h2>
                <div class="loading-state" id="calendarLoading">
                    <div class="loading-spinner"></div>
                    <p>Loading calendar...</p>
                </div>
                <div class="calendar-container glass-card" id="calendarContainer" style="display: none;">
                    <div class="calendar-header">
                        <button class="btn btn--secondary" id="prevMonth">‹</button>
                        <h3 id="currentMonth">August 2025</h3>
                        <button class="btn btn--secondary" id="nextMonth">›</button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Calendar will be generated dynamically -->
                    </div>
                    <div class="calendar-legend">
                        <div class="legend-item">
                            <div class="legend-color no-data"></div>
                            <span>No data</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color low"></div>
                            <span>1-20 questions</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color medium"></div>
                            <span>21-40 questions</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color high"></div>
                            <span>41-60 questions</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color very-high"></div>
                            <span>60+ questions</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Todo Section -->
        <section id="todos" class="section">
            <div class="container">
                <h2>Task Management</h2>
                <div class="todo-grid">
                    <div class="todo-form glass-card">
                        <h3>Add New Task</h3>
                        <div class="form-group">
                            <label for="todoTask">Task Description</label>
                            <input type="text" id="todoTask" class="form-control" placeholder="Enter your task">
                        </div>
                        <div class="form-group">
                            <label for="todoSubject">Subject</label>
                            <select id="todoSubject" class="form-control">
                                <option value="General">General</option>
                                <option value="Physics">Physics</option>
                                <option value="Chemistry">Chemistry</option>
                                <option value="Mathematics">Mathematics</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="todoPriority">Priority</label>
                            <select id="todoPriority" class="form-control">
                                <option value="Low">Low</option>
                                <option value="Medium">Medium</option>
                                <option value="High">High</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="todoDueDate">Due Date</label>
                            <input type="date" id="todoDueDate" class="form-control">
                        </div>
                        <button class="btn btn--primary btn--full-width" id="addTodo">Add Task</button>
                    </div>
                    <div class="todo-list glass-card">
                        <h3>Your Tasks</h3>
                        <div class="todo-filters">
                            <button class="filter-btn active" data-filter="all">All</button>
                            <button class="filter-btn" data-filter="pending">Pending</button>
                            <button class="filter-btn" data-filter="completed">Completed</button>
                            <button class="filter-btn" data-filter="high">High Priority</button>
                        </div>
                        <div class="todos-container" id="todosContainer">
                            <!-- Todos will be generated dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Modal for Calendar Day Details -->
    <div class="modal hidden" id="dayModal">
        <div class="modal-content glass-card">
            <div class="modal-header">
                <h3 id="modalDate">Date</h3>
                <button class="modal-close" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="modalQuestions">Questions Solved</label>
                    <input type="number" id="modalQuestions" class="form-control" min="0">
                </div>
                <div class="subject-inputs">
                    <div class="form-group">
                        <label for="modalPhysics">Physics</label>
                        <input type="number" id="modalPhysics" class="form-control" min="0">
                    </div>
                    <div class="form-group">
                        <label for="modalChemistry">Chemistry</label>
                        <input type="number" id="modalChemistry" class="form-control" min="0">
                    </div>
                    <div class="form-group">
                        <label for="modalMath">Mathematics</label>
                        <input type="number" id="modalMath" class="form-control" min="0">
                    </div>
                </div>
                <button class="btn btn--primary btn--full-width" id="saveModalProgress">Save</button>
            </div>
        </div>
    </div>

    <!-- Data Export Modal -->
    <div class="modal hidden" id="exportModal">
        <div class="modal-content glass-card">
            <div class="modal-header">
                <h3>Export Data</h3>
                <button class="modal-close" id="closeExportModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="export-options">
                    <button class="btn btn--secondary btn--full-width" id="exportAllJSON">Export All Data (JSON)</button>
                    <button class="btn btn--secondary btn--full-width" id="exportProgressCSV">Export Progress (CSV)</button>
                    <button class="btn btn--secondary btn--full-width" id="exportChaptersCSV">Export Chapters (CSV)</button>
                    <button class="btn btn--secondary btn--full-width" id="backupData">Create Backup</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="app.js"></script>
</body>
</html>